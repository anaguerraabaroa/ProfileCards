"use strict";const arrowList=document.querySelectorAll(".js-button");function getCollapsable(e){e.currentTarget.classList.toggle("rotateArrow");const t=e.currentTarget.id;document.querySelector(".section-"+t).classList.toggle("hideCollapsable")}for(let e=0;e<arrowList.length;e++)arrowList[e].addEventListener("click",getCollapsable);const cardContainer=document.querySelector(".js-cardContainer"),palette1=document.querySelector(".js-paletteRadio1"),palette2=document.querySelector(".js-paletteRadio2"),palette3=document.querySelector(".js-paletteRadio3"),palette4=document.querySelector(".js-paletteRadio4");function selectPalette(){!0===palette1.checked?form.palette=1:!0===palette2.checked?form.palette=2:!0===palette3.checked?form.palette=3:!0===palette4.checked&&(form.palette=4),renderPalette(),setLocalStorage()}function renderPalette(){cardContainer.classList.add("palette1"),cardContainer.classList.remove("palette2"),cardContainer.classList.remove("palette3"),cardContainer.classList.remove("palette4"),1===form.palette?cardContainer.classList.add("palette1"):2===form.palette?cardContainer.classList.add("palette2"):3===form.palette?cardContainer.classList.add("palette3"):4===form.palette&&cardContainer.classList.add("palette4")}function resetPalette(){!0===palette1.checked?palette1.checked=!1:!0===palette2.checked?palette2.checked=!1:!0===palette3.checked?palette3.checked=!1:!0===palette4.checked&&(palette4.checked=!1),renderPalette()}palette1.addEventListener("click",selectPalette),palette2.addEventListener("click",selectPalette),palette3.addEventListener("click",selectPalette),palette4.addEventListener("click",selectPalette);const inputList=document.querySelectorAll(".js-field");let inputValue,inputId,form={palette:"",name:"",job:"",phone:"",email:"",linkedin:"",github:"",photo:"url(https://i.picasion.com/pic90/02b56d6431f0a6fe7082958c95d7788d.gif)"};const resetButton=document.querySelector(".js-resetBtn");function saveField(e){inputValue=e.currentTarget.value,inputId=e.currentTarget.id,form[inputId]=inputValue,renderCard(),setLocalStorage()}function listenSaveField(){for(let e=0;e<inputList.length;e++)inputList[e].addEventListener("keyup",saveField)}function renderCard(){document.querySelector(".js-nameCard").innerHTML=form.name||"Nombre completo",document.querySelector(".js-positionCard").innerHTML=form.job||"Puesto",document.querySelector(".js-tlCard").href="tel:"+form.phone,document.querySelector(".js-emailCard").href="mailto:"+form.email,document.querySelector(".js-linkedinCard").href=form.linkedin,document.querySelector(".js-gitHubCard").href="https://github.com"+form.github,profileImage.style.backgroundImage=`url(${form.photo})`}const handleReset=function(){form.palette="",form.name="",form.job="",form.email="",form.phone="",form.linkedin="",form.github="",form.photo="url(https://i.picasion.com/pic90/02b56d6431f0a6fe7082958c95d7788d.gif)",localStorage.removeItem("formData");for(const e of inputList)e.value="";profileImage.style.backgroundImage="url(https://i.picasion.com/pic90/02b56d6431f0a6fe7082958c95d7788d.gif)",profilePreview.style.backgroundImage="url(https://i.picasion.com/pic90/02b56d6431f0a6fe7082958c95d7788d.gif)",renderCard(),resetPalette(),setLocalStorage()};resetButton.addEventListener("click",handleReset);const fr=new FileReader,uploadBtn=document.querySelector(".js__profile-trigger"),fileField=document.querySelector(".js__profile-upload-btn"),profileImage=document.querySelector(".js__profile-image"),profilePreview=document.querySelector(".js__profile-preview");function getImage(e){const t=e.currentTarget.files[0];fr.addEventListener("load",writeImage),fr.readAsDataURL(t)}function writeImage(){profileImage.style.backgroundImage=`url(${fr.result})`,profilePreview.style.backgroundImage=`url(${fr.result})`,form.photo=fr.result,setLocalStorage()}function fakeFileClick(){fileField.click()}uploadBtn.addEventListener("click",fakeFileClick),fileField.addEventListener("change",getImage);const createCardbtn=document.querySelector(".js-createCard-btn"),createCardCollapsable=document.querySelector(".js-createCard-link"),shareCollapsableBorder=document.querySelector(".js-navShare");function showLink(){createCardbtn.classList.add("btnClick"),createCardCollapsable.classList.remove("hideCollapsable")}function hideShareBorder(){shareCollapsableBorder.classList.toggle("hideLineShare")}createCardbtn.addEventListener("click",showLink),shareCollapsableBorder.addEventListener("click",hideShareBorder);const cardLink=document.querySelector(".js-card-link"),twitterButton=document.querySelector(".js-twitter-btn");function sendRequest(){fetch("https://us-central1-awesome-cards-cf6f0.cloudfunctions.net/card/",{method:"POST",body:JSON.stringify(form),headers:{"content-type":"application/json"}}).then((function(e){return e.json()})).then((function(e){showURL(e)})).catch((function(e){console.log(e),cardLink.innerHTML="Error en el servidor"}))}function showURL(e){e.success?(cardLink.href=e.cardURL,cardLink.innerHTML=cardLink.href):cardLink.innerHTML="ERROR: "+e.error}function createTwitterLink(e){const t=encodeURIComponent("Â¡Ya formo parte del mundo de las sombras gracias a DevilAPPers Profile Cards!:"),r=cardLink.innerHTML;twitterButton.href=`https://twitter.com/intent/tweet?text=${t}&url=${r}`}function setLocalStorage(){localStorage.setItem("formData",JSON.stringify(form))}function getLocalStorage(){const e=JSON.parse(localStorage.getItem("formData"));if(null!==e){form=e,document.querySelector(".js-nameInput").value=form.name,document.querySelector(".js-positionInput").value=form.job,document.querySelector(".js-tlInput").value=form.phone,document.querySelector(".js-emailInput").value=form.email,document.querySelector(".js-linkedinInput").value=form.linkedin,document.querySelector(".js-gitHubInput").value=form.github,profileImage.style.backgroundImage=`url(${form.photo})`,profilePreview.style.backgroundImage=`url(${form.photo})`;document.querySelector("#palette"+form.palette).click()}renderCard(),listenSaveField()}createCardbtn.addEventListener("click",sendRequest),twitterButton.addEventListener("click",createTwitterLink),getLocalStorage();